<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>College Basketball Rankings</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PWG43QNM3P"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-PWG43QNM3P');
</script>

<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f6f8; color:#111; }
  .page { max-width:1100px; margin:0 auto; padding:20px; }
  .top-nav { margin-bottom:20px; }
  .top-nav a { text-decoration:none; color:#111; font-weight:bold; font-size:0.9rem; }
  .top-nav a:hover { text-decoration:underline; }
  h1 { text-align:center; margin-bottom:10px; }
  .subtitle { text-align:center; margin-bottom:20px; color:#555; }
  .toggle-buttons { text-align:center; margin-bottom:20px; }
  .toggle-buttons button {
    padding:8px 16px; margin:0 5px; border:none; border-radius:6px; font-weight:bold; cursor:pointer; background:#ddd; transition:0.2s;
  }
  .toggle-buttons button.active { background:#111; color:#fff; }
  .toggle-buttons button:hover { background:#aaa; color:#fff; }

  table { border-collapse:collapse; width:100%; margin-top:10px; background:#fff; border-radius:6px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.08); }
  th, td { padding:8px 10px; border:1px solid #ccc; text-align:left; }
  th { background-color:#f2f2f2; cursor:pointer; user-select:none; }
  th.sort-asc::after { content:" ▲"; }
  th.sort-desc::after { content:" ▼"; }
  select { padding:6px 10px; margin-bottom:15px; border-radius:5px; border:1px solid #ccc; }

  .top10 { background:#e0f7fa; }
  .top3 { background:#e8f5e9; }
  .conf-leader { background:#fff3e0; }
  .win { background:#d0f0c0; }
  .lose { background:#f8d7da; }
  .auto-bid { background:#d4f0d4; }
  .at-large { background:#ffe4b2; }

  .matchup-box {
    background:#fff;
    padding:15px;
    border-radius:6px;
    box-shadow:0 4px 12px rgba(0,0,0,0.08);
    margin-bottom:15px;
  }
</style>
</head>

<body>
<div class="page">

  <div class="top-nav">
    <a href="index.html">← Back to College Basketball</a>
  </div>

  <h1 id="title">College Basketball Rankings</h1>
  <div class="subtitle">Elo-based rankings by season (2003–2026)</div>

  <div class="toggle-buttons" id="toggle-buttons" style="display:none;">
    <button id="show-elo" class="active">Elo Rankings</button>
    <button id="show-matchup">Hypothetical Matchup</button>
    <button id="show-projected">Projected Seeding</button>
    <button id="show-conf-elo">Conference Elo</button>
    <button id="show-conf-standings">Conference Standings (2026)</button>
    <button id="show-game-predictor">Game Predictor (2026)</button>
    <button id="show-resume">Resume (2026)</button>
  </div>

  <div id="elo-container">
    <table id="elo-table"><thead><tr></tr></thead><tbody></tbody></table>
  </div>

  <!-- Hypothetical Matchup -->
  <div id="matchup-container" style="display:none;">
    <div class="matchup-box">
      <select id="teamA"></select>
      <select id="teamB"></select>
      <button id="calcMatchup">Calculate</button>
      <div id="matchup-result" style="margin-top:10px;font-weight:bold;"></div>
    </div>
  </div>

  <div id="projected-container" style="display:none;">
    <table id="projected-table"><thead><tr></tr></thead><tbody></tbody></table>
  </div>

  <div id="conf-elo-container" style="display:none;">
    <table id="conf-elo-table"><thead><tr></tr></thead><tbody></tbody></table>
  </div>

  <div id="conf-standings-container" style="display:none;">
    <select id="conf-dropdown"></select>
    <table id="conf-standings-table"><thead><tr></tr></thead><tbody></tbody></table>
  </div>

  <div id="game-predictor-container" style="display:none;">
    <table id="game-predictor-table"><thead><tr></tr></thead><tbody></tbody></table>
  </div>

  <div id="resume-container" style="display:none;">
    <table id="resume-table"><thead><tr></tr></thead><tbody></tbody></table>
  </div>

</div>

<script>
const params = new URLSearchParams(window.location.search);
const year = params.get("year") || "2026";
document.getElementById("title").textContent = `College Basketball ${year} Rankings`;

const eloCsv = `data/CBB_Elo_${year}.csv`;
const projectedCsv = `data/projected_bracket${year}.csv`;
const confEloCsv = `data/CBB_Conference_Elo_${year}.csv`;

const eloContainer = document.getElementById("elo-container");
const matchupContainer = document.getElementById("matchup-container");
const projectedContainer = document.getElementById("projected-container");
const confEloContainer = document.getElementById("conf-elo-container");
const confStandingsContainer = document.getElementById("conf-standings-container");
const gamePredictorContainer = document.getElementById("game-predictor-container");
const resumeContainer = document.getElementById("resume-container");

const showEloBtn = document.getElementById("show-elo");
const showMatchupBtn = document.getElementById("show-matchup");
const showProjectedBtn = document.getElementById("show-projected");
const showConfEloBtn = document.getElementById("show-conf-elo");
const showConfStandingsBtn = document.getElementById("show-conf-standings");
const showGamePredictorBtn = document.getElementById("show-game-predictor");
const showResumeBtn = document.getElementById("show-resume");

let eloData = {};

function fetchCSV(path, callback){
  fetch(path).then(r=>r.text()).then(t=>{
    callback(t.trim().split("\n").map(r=>r.split(",")));
  });
}

fetchCSV(eloCsv, rows=>{
  rows.slice(1).forEach(r=>eloData[r[0]] = parseFloat(r[1]));
  const teamA=document.getElementById("teamA"), teamB=document.getElementById("teamB");
  Object.keys(eloData).forEach(t=>{
    teamA.add(new Option(t,t));
    teamB.add(new Option(t,t));
  });
});

document.getElementById("calcMatchup").onclick=()=>{
  const A=teamA.value, B=teamB.value;
  const diff=eloData[A]-eloData[B];
  const prob=1/(1+Math.pow(10,-diff/400));
  document.getElementById("matchup-result").textContent =
    `${A} win probability: ${(prob*100).toFixed(1)}%`;
};

function toggleTab(show, btn){
  [eloContainer,matchupContainer,projectedContainer,confEloContainer,confStandingsContainer,gamePredictorContainer,resumeContainer]
    .forEach(c=>c.style.display="none");
  [showEloBtn,showMatchupBtn,showProjectedBtn,showConfEloBtn,showConfStandingsBtn,showGamePredictorBtn,showResumeBtn]
    .forEach(b=>b.classList.remove("active"));
  show.style.display="block"; btn.classList.add("active");
}

showEloBtn.onclick=()=>toggleTab(eloContainer,showEloBtn);
showMatchupBtn.onclick=()=>toggleTab(matchupContainer,showMatchupBtn);
showProjectedBtn.onclick=()=>toggleTab(projectedContainer,showProjectedBtn);
showConfEloBtn.onclick=()=>toggleTab(confEloContainer,showConfEloBtn);
showConfStandingsBtn.onclick=()=>toggleTab(confStandingsContainer,showConfStandingsBtn);
showGamePredictorBtn.onclick=()=>toggleTab(gamePredictorContainer,showGamePredictorBtn);
showResumeBtn.onclick=()=>toggleTab(resumeContainer,showResumeBtn);
</script>
</body>
</html>
